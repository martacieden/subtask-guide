# Тестування компонента ModuleChecklist

## Об'єкт тестування
Компонент `ModuleChecklist` - відображає список модулів онбордингу з можливістю відмічати виконані завдання.

## Сценарії тестування

### 1. Збереження/Завантаження прогресу з localStorage ✅

**Очікувана поведінка:**
- При першому відкритті всі модулі мають `completed: false`
- Прогрес зберігається у `localStorage` з ключем `way2b1_module_progress`
- При перезавантаженні сторінки прогрес зберігається

**Тестові кроки:**
1. Відкрити головну сторінку (`/`)
2. Відмітити один модуль (клікнути на чекбокс)
3. Перевірити в DevTools → Application → Local Storage → `way2b1_module_progress`
4. Перезавантажити сторінку
5. Перевірити, що модуль залишається відміченим

**Результат:** [Треба виконати]

---

### 2. Кастомна подія `onboardingProgressUpdate` ✅

**Очікувана поведінка:**
- При зміні прогресу відправляється подія `onboardingProgressUpdate`
- `OnboardingProgressBadge` слухає цю подію та оновлює свій прогрес

**Тестові кроки:**
1. Відкрити консоль браузера (F12)
2. Додати слухач події:
   ```javascript
   window.addEventListener('onboardingProgressUpdate', () => {
     console.log('Progress updated!', localStorage.getItem('way2b1_module_progress'));
   });
   ```
3. Відмітити модуль у `ModuleChecklist`
4. Перевірити, що подія спрацювала
5. Перевірити, що `OnboardingProgressBadge` оновився

**Результат:** [Треба виконати]

---

### 3. Анімація прогресу (+20% Progress) ✅

**Очікувана поведінка:**
- При завершенні нового модуля показується анімація "+20% Progress!"
- Анімація зникає через 2 секунди

**Тестові кроки:**
1. Скинути весь прогрес (видалити `way2b1_module_progress` з localStorage)
2. Відкрити головну сторінку
3. Відмітити перший модуль
4. Перевірити, що з'явилася анімація з градієнтом
5. Перевірити, що анімація зникла через 2 секунди

**Результат:** [Треба виконати]

---

### 4. Модальне вікно завершення онбордингу ✅

**Очікувана поведінка:**
- Коли всі 6 модулів виконані, показується модальне вікно "You completed onboarding!"
- Модальне вікно має кнопку "Go to Resources & Guides"
- При кліку на кнопку відбувається навігація на `/resources`
- Після закриття модального вікна чеклист ховається

**Тестові кроки:**
1. Відмітити всі 6 модулів:
   - setup-domains
   - create-teams
   - add-demo-items
   - connect-integrations
   - add-team-member
   - configure-compliance
2. Перевірити, що модальне вікно з'явилося
3. Перевірити конфетті (confetti) анімацію
4. Клікнути "Go to Resources & Guides"
5. Перевірити навігацію на `/resources`
6. Повернутися на головну сторінку
7. Перевірити, що чеклист прихований

**Результат:** [Треба виконати]

---

### 5. Навігація та маршрутизація модулів ✅

**Очікувана поведінка:**
- Кожен модуль має правильний маршрут (`route`)
- При кліку на кнопку дії відбувається навігація на правильну сторінку
- Для спеціальних модулів встановлюються флаги в localStorage

**Тестові кроки:**

#### 5.1 Модуль "setup-domains"
- Клікнути "Create category"
- Перевірити навігацію на `/decisions`
- Перевірити `localStorage.getItem('way2b1_active_module') === 'setup-domains'`
- Перевірити `localStorage.getItem('way2b1_highlight_new_category') === 'true'`

#### 5.2 Модуль "create-teams"
- Клікнути "Create team"
- Перевірити навігацію на `/team`
- Перевірити `localStorage.getItem('way2b1_start_team_walkthrough') === 'true'`

#### 5.3 Модуль "add-team-member"
- Клікнути "Invite"
- Перевірити навігацію на `/team`
- Перевірити `localStorage.getItem('way2b1_start_team_walkthrough') === 'true'`

#### 5.4 Інші модулі
- Перевірити навігацію для всіх інших модулів

**Результат:** [Треба виконати]

---

### 6. Скидання модуля (Reset) ✅

**Очікувана поведінка:**
- Для завершеного модуля показується кнопка "Completed"
- При кліку на "Completed" модуль скидається
- Прогрес оновлюється в localStorage
- Відправляється подія `onboardingProgressUpdate`

**Тестові кроки:**
1. Відмітити модуль
2. Перевірити, що з'явилася кнопка "Completed"
3. Клікнути "Completed"
4. Перевірити, що модуль скинувся
5. Перевірити оновлення в localStorage
6. Перевірити подію в консолі

**Результат:** [Треба виконати]

---

### 7. Прогрес-бар ✅

**Очікувана поведінка:**
- Прогрес-бар показує правильний відсоток виконаних модулів
- Текст показує "X of 6"
- Градієнт має правильну ширину

**Тестові кроки:**
1. Перевірити початковий стан: "0 of 6", 0%
2. Відмітити 1 модуль: "1 of 6", ~16.67%
3. Відмітити 3 модулі: "3 of 6", 50%
4. Відмітити всі 6: "6 of 6", 100%

**Результат:** [Треба виконати]

---

### 8. Інтеграція з OnboardingProgressBadge ✅

**Очікувана поведінка:**
- При зміні прогресу в `ModuleChecklist` `OnboardingProgressBadge` оновлюється
- Показується правильний відсоток
- Після завершення показується "Setup Complete"

**Тестові кроки:**
1. Відкрити головну сторінку
2. Знайти `OnboardingProgressBadge` у топбарі
3. Відмітити модуль у `ModuleChecklist`
4. Перевірити оновлення бейджу
5. Завершити всі модулі
6. Перевірити, що бейдж показує "Setup Complete"

**Результат:** [Треба виконати]

---

### 9. Обробка помилок ✅

**Очікувана поведінка:**
- При некоректних даних у localStorage не має бути краш
- Помилки логуються в консоль

**Тестові кроки:**
1. Встановити некоректне значення:
   ```javascript
   localStorage.setItem('way2b1_module_progress', 'invalid json')
   ```
2. Перезавантажити сторінку
3. Перевірити, що додаток працює
4. Перевірити консоль на помилки

**Результат:** [Треба виконати]

---

## Виявлені та виправлені баги

### ❌ Баг #1: Неправильний ID модуля
**Проблема:** У `handleActionClick` перевірявся `moduleId === "create-category"`, але такого ID немає. Модуль має ID `"setup-domains"`.

**Локація:** `components/module-checklist.tsx:299`

**Виправлення:** Змінено `"create-category"` на `"setup-domains"`

**Статус:** ✅ Виправлено

---

### ❌ Баг #2: Дублювання логіки для setup-domains
**Проблема:** Логіка для `setup-domains` була розділена на дві умови:
- Перша умова встановлювала `way2b1_start_category_flow`
- Друга умова встановлювала `way2b1_highlight_new_category` та робила навігацію

**Локація:** `components/module-checklist.tsx:299-321`

**Виправлення:** Об'єднано логіку в одну умову, яка встановлює обидва флаги та робить навігацію

**Статус:** ✅ Виправлено

---

## Критичні баги для перевірки

1. ❓ Чи правильно зберігається прогрес при множинних змінах?
2. ❓ Чи відбувається навігація для всіх модулів?
3. ❓ Чи показується модальне вікно при завершенні всіх модулів?
4. ❓ Чи ховається чеклист після закриття модального вікна?
5. ❓ Чи працює інтеграція з OnboardingProgressBadge?

---

## Результати тестування

### ✅ Перевірено (код)
- Збереження/завантаження прогресу з localStorage - логіка коректна
- Кастомна подія `onboardingProgressUpdate` - викликається правильно
- Обробка помилок - є try/catch блоки
- Навігація модулів - всі маршрути налаштовані

### ⏳ Потрібно перевірити вручну (в браузері)
- Анімація прогресу (+20% Progress!)
- Модальне вікно завершення онбордингу
- Інтеграція з OnboardingProgressBadge
- Робота після перезавантаження сторінки
- Робота на мобільних пристроях

---

## Примітки

- Всі тести мають виконуватися в реальному браузері
- Використовувати DevTools для перевірки localStorage та подій
- Перевіряти як на десктопі, так і на мобільних пристроях
- Компонент використовує `"use client"`, тому не потребує перевірки `typeof window`
